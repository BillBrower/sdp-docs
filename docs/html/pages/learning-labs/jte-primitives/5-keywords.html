

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Keywords &mdash; Solutions Delivery Platform  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Summary" href="6-summary.html" />
    <link rel="prev" title="Application Environments" href="4-application-environments.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Solutions Delivery Platform
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://jenkinsci.github.io/templating-engine-plugin">Jenkins Templating Engine</a></li>
<li class="toctree-l1"><a class="reference external" href="https://boozallen.github.io/sdp-libraries">Pipeline Libraries</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deployment-guides/openshift/index.html">OpenShift</a></li>
</ul>
<p class="caption"><span class="caption-text">Learning Labs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../try-it-out/docs/index.html">Try It Out</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local-development/index.html">Local Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jte-the-basics/index.html">JTE: The Basics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">JTE: Pipeline Primitives</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-prerequisites.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-pipeline-job.html">Create a Pipeline Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-stages.html">Stages</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-application-environments.html">Application Environments</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-summary.html">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jte-advanced-features/index.html">JTE: Advanced Features</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/helm-multitenancy.html">Helm Multitenancy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/add_jenkins_credentials.html">Add Credentials to Jenkins</a></li>
<li class="toctree-l1"><a class="reference external" href="https://help.github.com/articles/creating-a-new-organization-from-scratch/">Create a GitHub Organization</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.twistlock.com/2018/05/08/securing-containers-red-hat-openshift-twistlock-deployment-script/">Deploy Twistlock to OpenShift</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute-to-docs.html">Contribute to this Documentation!</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Solutions Delivery Platform</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">JTE: Pipeline Primitives</a> &raquo;</li>
        
      <li>Keywords</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/pages/learning-labs/jte-primitives/5-keywords.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="keywords">
<span id="jte-primitives-keywords"></span><h1>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-a-keyword">
<h2>What is a Keyword?<a class="headerlink" href="#what-is-a-keyword" title="Permalink to this headline">¶</a></h2>
<p>Keywords allow you to define variables in the Pipeline Configuration that can be referenced
in your Pipeline Template.  This allows you to keep templates as readable as possible by
externalizing the definition of complex variables like regular expressions out of the template.</p>
<p>The most common use case so far for Keywords is storing regular expressions that map to common
branch names in the <a class="reference external" href="https://datasift.github.io/gitflow/IntroducingGitFlow.html">GitFlow Branching Strategy</a>
to be used in evaluating whether or not aspects of the pipeline should execute.</p>
<p>In this example, we’ll use a Keyword as a feature flag externalized from the Pipeline Template to conditionally
determine if a manual gate is required before the deployment to Production.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://jenkinsci.github.io/templating-engine-plugin/pages/Primitives/keywords.html">View the Keyword documentation</a></p>
</div>
</div>
<div class="section" id="define-and-use-a-keyword">
<h2>Define and Use A Keyword<a class="headerlink" href="#define-and-use-a-keyword" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-the-keyword-in-the-pipeline-configuration">
<h3>Define the Keyword in the Pipeline Configuration<a class="headerlink" href="#define-the-keyword-in-the-pipeline-configuration" title="Permalink to this headline">¶</a></h3>
<p>Update the <strong>Pipeline Configuration</strong> to:</p>
<div class="code groovy highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">libraries</span><span class="p">{</span>
    <span class="n">maven</span>
    <span class="n">sonarqube</span>
    <span class="n">ansible</span>
<span class="p">}</span>

<span class="n">stages</span><span class="p">{</span>
    <span class="n">continuous_integration</span><span class="p">{</span>
        <span class="n">build</span>
        <span class="n">static_code_analysis</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">application_environments</span><span class="p">{</span>
    <span class="n">dev</span><span class="p">{</span>
        <span class="n">ip_addresses</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;0.0.0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.0.2&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
    <span class="n">prod</span><span class="p">{</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Production&quot;</span>
        <span class="n">ip_addresses</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;0.0.1.1&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.1.2&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.1.3&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.1.4&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">keywords</span><span class="p">{</span>
    <span class="n">requiresApproval</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>All Keywords will be defined in the <code class="docutils literal notranslate"><span class="pre">keywords</span></code> block of the Pipeline Configuration.</p>
<p class="last">Traditional variable setting syntax of <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">b</span></code> is used to define Keywords.</p>
</div>
</div>
<div class="section" id="update-the-pipeline-template">
<h3>Update the Pipeline Template<a class="headerlink" href="#update-the-pipeline-template" title="Permalink to this headline">¶</a></h3>
<p>With the <code class="docutils literal notranslate"><span class="pre">continuous_integration</span></code> stage defined, we can update the pipeline template to make use of it.</p>
<p>Update the <strong>Pipeline Template</strong> to:</p>
<div class="code groovy highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">continuous_integration</span><span class="p">()</span>
<span class="n">deploy_to</span> <span class="n">dev</span>

<span class="k">if</span><span class="p">(</span><span class="n">requiresApproval</span><span class="p">){</span>
    <span class="n">timeout</span><span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="s1">&#39;MINUTES&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">input</span> <span class="s1">&#39;Approve the deployment?&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">deploy_to</span> <span class="n">prod</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>This is an example to demonstrate the use of a Keyword in a Pipeline Template and <strong>not</strong>
how we would recommend you enable this sort of gate in a production pipeline.</p>
<p class="last">We would recommend that, in practice, the deployment library inherits this manual gate approval
so that <code class="docutils literal notranslate"><span class="pre">requiresApproval</span></code> could be set on each Application Environment individually.</p>
</div>
</div>
<div class="section" id="run-the-pipeline">
<h3>Run the Pipeline<a class="headerlink" href="#run-the-pipeline" title="Permalink to this headline">¶</a></h3>
<p>From the Pipeline job’s main page, click <code class="docutils literal notranslate"><span class="pre">Build</span> <span class="pre">Now</span></code> in the lefthand navigation menu.</p>
<p>When viewing the build logs, you should see output similar to:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Pipeline] Start of Pipeline
[JTE] Pipeline Configuration Modifications (show)
[JTE] Loading Library maven (show)
[JTE] Library maven does not have a configuration file.
[JTE] Loading Library sonarqube (show)
[JTE] Library sonarqube does not have a configuration file.
[JTE] Loading Library ansible (show)
[JTE] Library ansible does not have a configuration file.
[JTE] Obtained Pipeline Template from job configuration
[Pipeline] node
Running on Jenkins in /var/jenkins_home/workspace/single-job
[Pipeline] {
[Pipeline] writeFile
[Pipeline] archiveArtifacts
Archiving artifacts
[Pipeline] }
[Pipeline] // node
[JTE] [Stage - continuous_integration]
[JTE] [Step - maven/build.call()]
[Pipeline] stage
[Pipeline] { (Maven: Build)
[Pipeline] echo
build from the maven library
[Pipeline] }
[Pipeline] // stage
[JTE] [Step - sonarqube/static_code_analysis.call()]
[Pipeline] stage
[Pipeline] { (SonarQube: Static Code Analysis)
[Pipeline] echo
static code analysis from the sonarqube library
[Pipeline] }
[Pipeline] // stage
[JTE] [Step - ansible/deploy_to.call(ApplicationEnvironment)]
[Pipeline] stage
[Pipeline] { (Deploy To: dev)
[Pipeline] echo
performing a deployment through ansible..
[Pipeline] echo
deploying to 0.0.0.1
[Pipeline] echo
deploying to 0.0.0.2
[Pipeline] }
[Pipeline] // stage
[Pipeline] timeout
Timeout set to expire in 5 min 0 sec
[Pipeline] {
[Pipeline] input
Approve the deployment?
Proceed or Abort
Approved by admin
[Pipeline] }
[Pipeline] // timeout
[JTE] [Step - ansible/deploy_to.call(ApplicationEnvironment)]
[Pipeline] stage
[Pipeline] { (Deploy To: Production)
[Pipeline] echo
performing a deployment through ansible..
[Pipeline] echo
deploying to 0.0.1.1
[Pipeline] echo
deploying to 0.0.1.2
[Pipeline] echo
deploying to 0.0.1.3
[Pipeline] echo
deploying to 0.0.1.4
[Pipeline] }
[Pipeline] // stage
[Pipeline] End of Pipeline
Finished: SUCCESS
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>When reading the build logs of a JTE job, you can identify the start of stages by looking for
<code class="docutils literal notranslate"><span class="pre">[JTE]</span> <span class="pre">[Stage</span> <span class="pre">-</span> <span class="pre">*]</span></code> in the output.</p>
<p class="last">In this case, the log output was: <code class="docutils literal notranslate"><span class="pre">[JTE]</span> <span class="pre">[Stage</span> <span class="pre">-</span> <span class="pre">continuous_integration]</span></code> indicating a Stage
called <code class="docutils literal notranslate"><span class="pre">continuous_integration</span></code> is about to be executed.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The exercise of setting <code class="docutils literal notranslate"><span class="pre">requiresApproval</span> <span class="pre">=</span> <span class="pre">false</span></code> and seeing the difference is left
to the reader.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="6-summary.html" class="btn btn-neutral float-right" title="Summary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="4-application-environments.html" class="btn btn-neutral float-left" title="Application Environments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Booz Allen Hamilton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-144247959-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>